# GearLab Tools PHP SDK

![Travis CI build status](https://api.travis-ci.org/sitecrafting/gearlab-tools-php.svg?branch=master)

The official PHP SDK for the GearLab Tools REST API.

## Requirements

PHP 7.1 and later

## Installation & Usage
### Composer

Install via Composer:

```sh
composer require sitecrafting/gearlab-tools-php
```

## Tests

To run the unit tests:

```sh
composer install
./vendor/bin/phpunit
```

## Getting Started

Please follow the [installation procedure](#installation--usage) and then run the following:

```php
<?php
require_once(__DIR__ . '/vendor/autoload.php');

// key, baseUri, and collection are all required.
$client = new Client([
  'key'        => $in->getOption('key'),
  'baseUri'    => $in->getOption('base-uri'),
  'collection' => $in->getOption('collection'),
]);

$searchResults = $client->search([
  'query'        => 'trees',   // required
  'resOffset'    => 10,        // defaults to 0
  'resLength'    => 42,        // defaults to 10
  'metaTag'      => 'SO-META', // defaults to ""
  'literalQuery' => true,      // defaults to false
]);

$searchCompletions = $client->completions([
  'prefix'  => 'spongeb',
  'metaTag' => 'SO-META', // defaults to ""
]);

?>
```

### Example Results

#### Search

```json
{
  "resSet": [
    {
      "results": [
        {
          "res": {
            "url": "https://www.example.com/cocoa-policy/",
            "title": "Hot Cocoa Policy",
            "snippet": "In the wake of last year's hot cocoa incident, we've decided that all drinks served at the holiday party must be machine washable.",
            "meta": {}
          }
        }
      ],
      "recommendations": [
        {
          "res": {
            "url": "https://www.example.com/cocoa-policy/",
            "title": "Hot Cocoa Policy",
            "snippet": "In the wake of last year's hot cocoa incident, we've decided that all drinks served at the holiday party must be machine washable.",
            "meta": {}
          }
        }
      ],
      "resOffset": 20,
      "resStart": 21,
      "resEnd": 30,
      "resCount": 10,
      "total": 47,
      "literalQuery": "false",
      "originalQueryPhrase": "holiday party",
      "suggestionSupersededQuery": "false",
      "supersedingSuggestion": "corrected spelling"
    }
  ]
}
```

#### Completions

```json
{
  "resSet": {
    "results": [
      {
        "res": {
          "title": "Support Number"
        }
      }
    ]
  }
}
```

## Architecture

This package incorporates PHP code that is automatically generated by the [Swagger Codegen](https://github.com/swagger-api/swagger-codegen) project from the [GearLab Tool API Spec](https://app.swaggerhub.com/apis-docs/ctamayo/gearlab-tools/v2). The generated code is exported automatically when the spec is saved in Swagger Hub, and is contained entirely in the `swagger/SwaggerClient-php` directory within this repo. The Composer autoloader is configured to autoload this code:

```json
{
    "autoload": {
        "psr-4": {
          "Swagger\\Client\\": "swagger/Swagger-Client-php/lib/",
          "GearLab\\Api\\": "src/"
        }
    },
    "autoload-dev": {
        "psr-4": {
          "Swagger\\Client\\" : "swagger/Swagger-Client-php/test/",
          "GearLab\\Api\\": "test/"
        }
    }
}
```

The `GearLab\Api\Client` class serves as the main entrypoint for all API calls, and normalizes the usage of the autogenerated code. For example, it translates array query arguments into positional arguments that the autogen code expects.

- API version: v2
- Build package: io.swagger.codegen.languages.PhpClientCodegen

